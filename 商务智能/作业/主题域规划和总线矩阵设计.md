## 一、主题域规划和总线矩阵设计

### 1、主题域规划

##### 教学主题域：

- 相关主题：选课管理、学籍管理
- 涉及部门：教学管理部

##### 财务主题域：

- 相关主题：各单位收支管理、教职工薪资管理
- 涉及部门：教学管理部、财务管理部、后勤管理部、物流管理部

##### 后勤主题域：

- 相关主题：食堂开销
- 涉及部门：食堂管理部门、财务管理部门

##### 图书管理主题域：

- 相关主题：图书订购、图书零售、图书借阅、图书库存
- 涉及部门：物流管理部、财务管理部、图书馆管理部

##### 人力资源主题域：

- 相关主题：教职评选、劳务管理
- 涉及部门：人力资源管理部、财务管理部

### 2、总线矩阵设计

|                | 日期 | 学生 | 教师 | 工勤人员 | 课程 | 合同 | 财务 |
| -------------- | ---- | ---- | ---- | -------- | ---- | ---- | ---- |
| 选课管理       | ✓    | ✓    | ✓    |          | ✓    |      |      |
| 学籍管理       | ✓    | ✓    |      |          | ✓    |      |      |
| 各单位收支管理 | ✓    |      |      |          |      |      | ✓    |
| 教职工薪资管理 | ✓    |      | ✓    | ✓        |      |      | ✓    |
| 食堂开销       | ✓    |      |      |          |      |      | ✓    |
| 图书订购       | ✓    |      |      | ✓        |      | ✓    | ✓    |
| 图书借阅       | ✓    | ✓    | ✓    |          |      |      |      |
| 图书库存       | ✓    |      |      | ✓        |      |      |      |
| 教职评选       | ✓    |      | ✓    |          |      |      |      |
| 劳务管理       | ✓    |      | ✓    | ✓        |      | ✓    |      |

### 3、公共维度设计

##### 日期维度：

- 结构
  - 日期关键字（PK）
  - 日期
  - 日历年
  - 日历月
  - 日历星期
  - 节日指示符
  - 寒暑假指示符

##### 学生维度：

- 结构
  - 学号（PK）
  - 入学时间
  - 身份证号
  - 所在院系
  - 所在专业
  - 班级编号
  - 联系电话
  - 邮箱地址

##### 教师维度：

- 结构
  - 教师号（PK）
  - 入职时间
  - 身份证号
  - 所在院系
  - 所在实验室
  - 科研成果
  - 所教课程
  - 联系电话
  - 邮箱地址

##### 工勤人员维度：

- 结构
  - 工号（PK）
  - 入职时间
  - 身份证号
  - 所在部门
  - 职务类型
  - 劳务合同（FK）
  - 联系电话
  - 邮箱地址

##### 课程维度：

- 结构
  - 课程号（PK）
  - 课程名
  - 参考书目
  - 教学内容
  - 教学目标
  - 教学周历

##### 合同维度：

- 结构
  - 合同号（PK）
  - 甲方代表
  - 乙方代表
  - 合同类型
  - 合同内容
  - 开始日期
  - 结束日期

##### 财务维度：

- 结构
  - 财务活动号（PK）
  - 财务类型
  - 所属单位
  - 附加描述

### 4、小组分工

| 姓名   | 学号      | 分工                                                         |
| ------ | --------- | ------------------------------------------------------------ |
| 刘鹏程 | 171250552 | 公共维度、总线矩阵。图书管理主题域: 图书订购、图书零售、图书借阅、图书库存 |
| 封福建 | 171250550 | 人力资源主题域: 教职评选、劳务管理                           |
| 赖宝光 | 171250524 | 财务管理主题域: 各单位收支管理、教职工薪资管理               |
| 锁强   | 171250602 | 后勤主题域: 食堂开销；教学主题域: 选课管理、学籍管理         |

## 二、维度建模

### 1、图书订购

描述：图书管理处有批量订购图书的工作，不同类型图书有不同的订购需求量，和不同厂家签订不同的合同。该分析应用业务主要是为了分析图书馆中图书的订购活动，从而提高图书订购的效率与效益、节省开销

##### 1.1 选取业务处理

- 哪位订购负责人，在什么时间，签订了哪个订购合同，订购了什么图书，以及订购的图书数量和总价

##### 1.2 定义粒度

- 单次图书订购业务

##### 1.3 选取维度

- 订购日期维度、图书维度、合同维度、事务类型维度、事务负责人维度

##### 1.4 选取度量值

- 订购的图书数量，订购的总花费

##### 1.5 多维建模设计

![图书订购](D:\chrome下载\图书订购.png)

##### 1.6 设计原因

- 使用星型模型设计，因为系统可以接收冗余信息，同时各个维表的内容规模相对合适，没有进一步层次化的必要。同时星型模型也有利于查询分析操作，减少分析时间

- 部分图书的订购事件往往相对频繁，如期刊、杂志、报纸等；部分图书订购相对不频繁，如教材。所以以订购事件为基准，采用事务事实表。此时订购的原子事务数据就是对应的多维数据

### 2、图书零售

描述：部分图书如教材、教辅、杂志等，图书管理处为学生提供了相关零售渠道。对应的分析业务主要是通过不同种类图书的销售情况，分析不同类别的学生对相关图书的需求状况，便于决定相关图书的订购量。同时管理处也会对部分滞留书籍进行促销，因此也会有对不同促销策略影响的分析应用业务。

##### 1.1 选取业务处理

- 分析一本书，是在哪天、以何种促销方式被销售给哪个学生

##### 1.2 定义粒度

- 单人单次单本图书的销售条目

##### 1.3 选取维度

- 订购日期维度、图书维度、促销维度、学生维度、零售事务编号

##### 1.4 选取度量值

- 销售数量、销售金额、成本金额、毛利润金额

##### 1.5 多维建模设计

![图书零售](D:\chrome下载\图书零售.png)

##### 1.6 设计原因

- 有时需要分析正在促销但还没有销售完的图书，这种分析不能通过事务事实表完成，所以引入零售记录非事实型事实表
- 零售事务编号没有具体的维属性，于是使用退化维度
- 使用星型模型，考虑到对零售事务进行分析会相对频繁一些，便于及时调整优惠策略，因此使用星型模型增加冗余，减少分析时间

### 3、图书借阅

描述：部分图书是供学生或者教师借阅用的，为了获取学生或者教师借阅图书的倾向，提高图书订购的针对性，满足更多师生的需求，需要分析不同学生、不同教师对不同种类书籍的借阅需求和借阅行为

##### 1.1 选取业务处理

- 分析哪个学生或教师，在哪天、借阅了哪本书

##### 1.2 定义粒度

- 单人单次对单本图书的借阅

##### 1.3 选取维度

- 日期维度、图书维度、借阅者维度（学生维度、教师维度）

##### 1.4 选取度量值

- 借阅图书数量

##### 1.5 多维建模设计

![图书借阅](D:\chrome下载\图书借阅.png)

##### 1.6 设计原因

- 考虑学生和教师在粒度上是一致的，都属于学校的人员，但是其个人信息有许多不同的属性。考虑使用一致性维度，统一为借阅者维度放入事实表
- 使用雪花维度，因为如果直接采用星型维度，那么教师维度与学生维度直接共享属性较少，易产生大量冗余。另一方面查询深度不深，时间开销应该可以接收
- 为了保证参照完整性，在学生维度表和教师维度表中都保存一项为不可用；或者是用描述性字符串替换空值表示不可用。使用的时候，引用其中一种时，另一种设置为不可用。同时可以根据借阅者类型这一条件，来判断连接到教师维度还是学生维度

### 4、图书库存

描述：该分析应用业务主要是记录图书库存的变化情况，反映图书入库、出库前后的变化，以及图书库存量是否能满足需求。注意借阅与图书库存不相关，入库出库相关的事务指的是图书批量订购和批量出售。考虑两种业务处理过程

##### 1.1 选取业务处理

- 第一种业务处理为记录每一个引起库存发生变化的事务，内容包括事务的事件，图书库存事务的类型，图书类型，以及相关事务的负责人
- 第二种业务处理为记录每一个时间周期结束时（这里时间周期设为一天），库存的状况，即某天结束时，某种图书的剩余库存量

##### 1.2 定义粒度

- 第一种是以单次入库、出库事务为粒度
- 第二种是以固定时间间隔内库存的情况为粒度

##### 1.3 选取维度

- 第一种：日期维度、图书维度、库存事务类型维度、事务负责人维度
- 第二种：日期维度、图书维度、仓库维度

##### 1.4 选取度量值

- 第一种：库存事务涉及某类图书的数量，该库存事务涉及的总金额
- 第二种：相关仓库中相应图书的库存数量

##### 1.5 多维建模设计

![图书库存事实表](D:\chrome下载\图书库存事实表.png)

##### 1.6 设计原因

- 使用库存事务事实表方便反映库存操作的详细信息，回答周期快照因为粒度问题不能回答的问题

- 考虑事务事实表难以对阶段性库存性能进行分析，于是引入库存周期快照进行辅助分析

- 由于图书库存流程相对简单，跟踪图书库存运动意义不大，不考虑库存累积快照

- 都采用星型模型进行设计，因为可用的存储空间足够，且针对分析的业务，各个维表内容不需要进一步拆分，也不需要在各个维表中连接更多的维度。有利于分析应用的查询性能

  