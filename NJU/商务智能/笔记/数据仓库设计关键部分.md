### 1、操作型数据库 vs 数据仓库

- 面向处理类型不同
  - 面向应用 vs 面向分析
- 面向的需求不同
  - 确定的应用需求 vs 不确定的分析需求
- 系统设计目标不同
  - 事务处理性能 vs 全局一致的数据环境
- 数据来源或系统输入不同
  - 事务相关数据 vs 多种多样
- 系统设计的方法和步骤不同
  - SDLC vs CLDS

### 2、数据仓库设计原则

- 面向主题
  - 建立数据仓库目的：满足用户决策的需要
  - 数据组织方法：以主题为起始点
- 数据驱动原则
  - 从已经存在于操作型环境的数据出发，进行数据仓库的设计
- 原型法设计原则
  - 不断变化的分析需求
  - 逐步求精的设计过程
  - 启发方式：一个迭代的开发依赖于上一个迭代结果

### 3、数据仓库设计的三级数据模型

- 概念模型
  - 为一定目标设计系统、收集信息而服务的概念型工具
  - E-R法
- 逻辑模型
  - 描述了数据仓库主题的逻辑实现
  - 关系模型
- 物理模型
  - 逻辑在数据仓库的实现

### 4、数据仓库的设计步骤

###### 1、系统规划

- 明确主题：定初步主题概念，以后逐步扩充完善
- 技术准备

###### 2、概念设计

- 确定系统边界：决策类型、问题、信息、数据源
- 确定主要的主题和内容：明确数据仓库的分析对象
  - 确定后就可以用实体联系E-R模型表示概念数据模型

###### 3、逻辑设计

- 将E-R图转为关系数据库的二维表
- 定义数据源和数据抽取规则
- 粒度划分：一般分为**<u>详细数据、轻度总结、高度总结</u>**；或其他粒度方法
  - 影响数据量以及适合的查询类型
- 数据分割
  - 逻辑上统一整体的数据分割成较小的、可以独立管理的数据单元
  - 方便重构、重组、恢复，提高创建索引和顺序扫描的**效率**
  - 数据分割因素：数据量大小、主题、简单分割标准、粒度划分
  - 通常**用“时间”属性作为分割标准**
- 定义数据来源以及抽取规则

###### 4、物理设计

- 逻辑基础上，确定数据存储结构、索引策略、存储分配、数据存放位置等，目的：**提高数据仓库访问性能**
- 常用技术（**<u>考</u>**）
  - 合并表：类似于传统RDBMS的 集簇
    - 很多分析操作需要多表连接。为了节省IO开销，可以把表中记录**混合存放在一起**，减低表连接操作代价
  - 数据序列
    - 考虑创建一个数据序列，这样如果数据存放在一行中，那么一次IO就足以检测到了
    - 通常数列中的**值数量稳定**、数据按**顺序访问**、数据的**创建与修改**在统计上非常**有规律**时，创建一个数据序列才有意义
  - 引入冗余
    - 可以**修改关系模式**把某些属性**复制**到多个不同的主题表中，**减少一次分析过程需要访问表的数量**
    - 这种数据组织方式会带来大量数据冗余存储，需要保证一致性。而正因为DW数据稳定很少更新，不会因此带来很大的代价。提升性能
  - 表的物理分割
    - 根据每个属性数据的访问频率和稳定性，对**表的存储结构进行分割**
      - **访问频率**较高的单独考虑物理存储组织，制定索引策略和物理组织方式
      - **频繁更新**的属性也可以单独组织物理存储，以免数据更新带来空间重组、重构等
  - 生成导出数据
    - 在**原始、细节数据**的基础上进行**统计和计算**，生成导出数据，保存在数据仓库
    - 避免分析时太多统计和计算操作，减少IO，提高分析性能
    - 避免不同用户重复统计操作可能的偏差
  - 建立广义索引
    - 记录数据仓库中与**“最”相关**的统计结果的索引，成为“广义索引”
      - 如销售额最高的商店
    - 这种数据量很小，可以在数据加载或刷新时建立这种广义索引。用户可直接获得，不必扫描整个DW

###### 5、数据仓库生成

- 建立数据模式：根据逻辑和物理的结果
- 编制数据抽取程序：根据数据仓库元数据的定义信息编制
- 数据加载：用刚才的数据抽取程序

###### 6、数据仓库运行与维护

- 数据仓库建立后，就可以建立分析、决策型的应用系统
- 使用过程中加深理解，用原型法完善
- 数据源变化，用数据刷新保证一致性