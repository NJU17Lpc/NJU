# 维度建模

### 1、事实表

- 这是维度建模的核心和基本表
- 每一个事实表对应着一个或者若干个“度量值”
  - 度量值是事实表的核心
  - 通过事实表来记录维度值与度量值之间的关系
- 事实表中一行对应一个度量值
  - 事实表中所有度量值都必须有相同的粒度
- 事实表中的关键字
  - 每个事实表都会有两个或两个以上的foreign key
  - 通过**外关键字**建立**事实表和维度表的关系**
    - **维度表**是来存取事实表中的**度量值**的
  - 可以由**外关键字**的组合构成**事实表**的**主关键字primary key**

### 2、度量值

- 常用度量值：数值类型
- 通常是可以连续取值的量
- 三种类型
  - 可做加法运算
  - 可以沿着某个维度做加法
  - 不能做加法运算

### 3、维度表

- 是事实表的入口，为用户提供了使用数据仓库的接口
- 维度表中的维度属性，通常用于定义事实表上的查询条件，也可以用作定义报表和统计查询的列
- 维度表的定义：**<u>尽可能多的列，相对于事实表较少的行</u>**

### 4、维度属性

- 通常是文本或者离散数据
- 尽量少使用编码属性？？？？
- **维度属性**与**度量值**的区别
  - 维度属性：离散/取值不多；属性不变/很少产生变化/从不参与统计计算，但经常用于查询条件
  - 度量值属性：有许多取值，可以参加统计运算

### 5、事实表和相关维度表的连接

- 一个每日销售情况的事实表，有很多外关键字
- 每个外关键字连接到其他维度表，比如日期关键字连接到日期维度



**<u>维度建模，参考：“数据仓库生命周期工具箱：设计、开发和部署数据仓库的专家方法”</u>**



### 6、维度建模的设计过程

- 选取要建模的业务处理过程（这里肯定是分析型）
  - 如：什么样的促销条件下，在什么样的日子里，在什么商店，销售什么样的商品
- 定义业务处理的粒度
  - 事实表每行度量值的取值粒度
  - 如：以单个商品条目为粒度
- 选择事实表中的维度
  - 如：零售事务的事实表中，有日期维度、产品维度、促销维度、商场维度
- 选择事实表中的度量值
  - 可以有多个度量值
  - 以分析对象为依据
  - 首先确定事实：零售事务事实表中，有销售量、销售额、成本额、**毛利润金额**这些事实
    - 注意：**毛利润金额** 是可以通过计算而获得的可加性度量值，可以物理存在事实表里
    - 而没有可加性的计算结果，应该由访问过程中进行计算，比如**单价，存在产品维度表**
  - 下面维度设计
    - 日期维度
      - 每个数据仓库都要具备，可以事先建立5-10年的日期维度值
      - 属性可以有：日期关键字、编号、年月、日历季度、日历年、财政周、节假日提示周日提示符...
    - 产品维度
      - 包含两类属性
        - 产品的多级体系划分属性
          - SKU编号--小类描述--大类描述--部门描述
          - 每一级都是多对一的关系，于是构成关于商品的**分类体系**
          - （于是就可以进行**下钻**两层）
            - 原来看到：面包房，销售额xxx
            - 现在，面包房，炸薯条，销售额xx; 面包房，软糕点，销售额xx
        - 其他描述属性
          - 包装属性、脂肪含量...
          - **不是产品体系组成部分**，可以和**产品体系划分属性，组合**在一起，进行有意义分析应用
          - (于是可以通过脂肪含量这个属性，对面包房进行划分，下钻一层)
            - 面包房，无脂，销售额xx







